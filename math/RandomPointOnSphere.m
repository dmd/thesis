function p = RandomPointOnSphere(radius,origin)% RandomPointOnSphere ( radius as scalar, origin as [x y z] )% if no origin given, assumes [0 0 0]% if no radius or origin given, assumes radius = 1, origin = [0 0 0]% method: choose random 0 <= theta < 2pi%               -pi <= phi <= pi%% 2003 ddrucker@psych.upenn.eduif nargin==0    radius = 1;    origin = [0 0 0];elseif nargin==1    origin = [0 0 0];endtheta = 2*pi * rand;phi = 2*pi * rand - pi;rho = radius;[x,y,z] = sph2cart(theta,phi,rho);x = origin(1) + x;y = origin(2) + y;z = origin(3) + z;p = [x y z];if size(origin) == [3 1]    p=p';end